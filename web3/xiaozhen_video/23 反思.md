# 智能合约真的只能吗？

智能合约并没有用到任何AI的内容，所以有人认为应该称作自动合约。现实生活中，自动合约的例子有ATM取款机。

**所以智能合约只是一个代码合同**

# 不可篡改性其实是把双刃剑

一方面增加了合约的公信力，大家只能按照规则，无人能篡改。另一方面如果合约中有漏洞，是无法修改的。

TheDAO在发生盗币事件前几天已经收到了存在漏洞的相关告警，但无法升级软件来修复。这在中心化系统里是无法想象的。

而且我们无法对攻击行为作出反应。日常生活中如果银行卡被盗，可以通知银行冻结账户。但区块链世界里，无法进行冻结。一定要冻结只能通过软分叉。

实际上ETH不会因为个人账户的私钥泄漏而发布软分叉。智能合约一旦发布到链上，无法阻止被调用。

假如你是TheDAO的投资人之一，发生盗币事件后，如何避免损失？
可行的方案就是同样也利用这个漏洞，创建一个合约并公布出去，将剩下的2/3ETH转到这个合约里，通过这个合约把钱退给大家。

# 没有什么是不可篡改的

没有什么是不可篡改的，软件是死的，但人是活的

# Solidity语言设计存在的问题

1. 为什么会出现重入攻击？

Solidity语言的设计，是反直觉的。我向你转账，调用到了fallback函数，结果反过来你还可以调用我。

有人提出使用函数式编程语言，函数式语言比较容易做形式化验证。

2. 编写智能合约的语言，要具备什么样的表达能力

BTC的脚本语言很简单，ETH的脚本语言solidity却是图灵完备的。这种图灵完备的表达能力是不是一个好事情？有些人认为应该选取一个表达能力适中的语言，可以实现智能合约的功能，但又不容易出现安全漏洞。

很难找到这种编程语言，设计语言时很难预料到将来的应用场景和安全攻击。

现实世界中，合同是由自然语言编写的，也很容易出现漏洞和纠纷。所以人们现在写合同都是从模板开始写，而不是从零开始。未来常用的智能合约功能，可能会出现模板，也可能会出现一些专门编写智能合约的机构，就像律所一样。

# 区块链合约开源的问题

为什么开源的软件被全世界的人看到，仍然会出现这么多漏洞？

实际上一个开源软件公布出来，只有极少数人会看。TheDAO的投资人也不是所有人都会去审查合约的内容。

# 硬分叉到底是不是导致了中心化

ETH提出了硬分叉的方案，是由投票来得出的结论。而最终能够成功，是因为90%的矿工升级了软件，而剩下10%留在旧链，ETH团队无法强迫。

区块链的世界里是用挖矿来投票的，这次硬分叉能够成功，根本原因是因为大多数矿工，认为这个决定是符合公众利益的。

分叉一般认为是个坏事，但这恰恰是对去中心化的体现。在一个中心化系统里，是无法分叉的，只能选择放弃。

ETH创始人最初创立ETH的原因，是因为他喜欢玩WOW，而暴雪公司把他喜欢的职业术士的一个技能删去了，他多次向暴雪公司反馈但没有回应。于是一气之下不玩了。

他发现这是因为WOW是一个中心化的系统，决定权在开发公司。所以他决定要创建一个去中心化的平台，用户不满意，就有选择分叉的权利。

美联储进行量化宽松政策，导致很多退休老人不满，但是没有办法。在去中心化世界里，假如未来有一天ETH团队也量化宽松，增发大量ETH，导致矿工的不满，此时矿工就可以选择分叉，继续维护原来的链和货币。所以分叉恰恰是去中心化民主的体现。

# 去中心化不等于分布式

一个去中心化的系统，必然是分布式的。但一个分布式系统不一定是去中心化的。

BTC和ETH都属于交易驱动状态机，特点是让系统中几千台机器重复做同一个操作，付出很大代价，来维护状态一致性。这并不是分布式系统常用的工作模式，大多数分布式系统是让每台机器做不同事情，然后汇总起来得到结果，目的是速度更快。

这并不是状态机的工作模式，状态机是为了mission critical applications这类应用工作的，例如空中交通管控、证券交易、航天飞船。这类应用特点是必须无间断的对外提供服务，所以需要很多台机器同时进行状态计算，且不断同步状态。但是往往机器数量越多，效率反而越慢。所以传统状态机里，机器数目都是个位数。像区块链这种模式，是状态机系统里少见的。

智能合约是用来编写控制逻辑的，需要在互不信任的实体之间，建立共识的操作，才需要写入智能合约。如果需要大规模计算，可以用AWS。